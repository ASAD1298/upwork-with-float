(window.webpackJsonp=window.webpackJsonp||[]).push([[320],{1973:function(e){e.exports=JSON.parse('{"asui_PleaseWait_12":"Please wait..."}')},1974:function(e){e.exports=JSON.parse("{}")},2154:function(e,t,n){"use strict";n.r(t);var o=n(26),r=n(92),c=n(93),l=n(131),d=n(133),h=n(132),w=n(1),m=n(78),v=n(53),f={en:n(1973),is:n(1974)};w.default.use(m.a);var k=new m.a({fallbackLocale:"en",silentFallbackWarn:!0,locale:"undefined"==typeof window?"en":Object(v.a)("lang")||"en",messages:f}),_="cloudflare";let y={};var O={externalCaptchaRequested:async e=>!(403!==e.status&&503!==e.status||!(null!=e.headers.get("cf-chl-bypass")||e.headers.get("cf-mitigated")&&"challenge"===e.headers.get("cf-mitigated")||-1!==(await e.clone().text()).indexOf("cloudflare.com")))&&_,async handle(e,t){let n=y[e];return n||(C("user_challenged"),await Promise.all(Object.values(y)),n=async function(e){const iframe=await function(e){const iframe=document.createElement("iframe");Object.assign(iframe.style,{width:"100%",height:"100%",position:"fixed","z-index":99999999,backgroundColor:"white",top:0}),iframe.style.setProperty("display","block","important"),iframe.setAttribute("id","externalChallenge"),iframe.innerText=k.t("asui_PleaseWait_12"),document.body.appendChild(iframe);const t=new Promise((e=>{iframe.onload=()=>{iframe.onload=void 0,iframe.prevContentDocument=iframe.contentDocument,e(iframe)}}));return iframe.src="".concat(e+(e.includes("?")?"&":"?"),"cloudflareLoader"),t}(e);do{await S(iframe)}while(!await P(e));iframe.remove()}(t),y[e]=n,n.then((()=>{delete y[e],setTimeout((()=>{C("challenge_passed")}),1e3)})))}};async function P(e){const t=await fetch(e+(e.includes("?")?"&":"?")+"endpointCheck");return 403===t.status&&C("challenge_failed"),403!==t.status}function S(iframe){return new Promise((e=>{const t=setInterval((()=>{iframe.contentDocument!==iframe.prevContentDocument&&(iframe.prevContentDocument=iframe.contentDocument,C("challenge_tried"),clearInterval(t),e())}),300)}))}function C(e){"undefined"!=typeof window&&window.$nuxt&&window.$nuxt.$tracker&&window.$nuxt.$tracker.track({event:"impression",sublocation:"page",label:e,trackers:["snowplow"]})}let x=[(e,t,n)=>401!==e.status||t.tokenRefreshWasPerformed?e:(t.tokenRefreshWasPerformed=!0,j(h.a).middlewares([Object(r.a)(),Object(c.a)([Object(d.a)()])],!0).get().res((()=>n())))],T=[e=>(t,n)=>function o(){return e(t,n).then((async e=>{const n=await O.externalCaptchaRequested(e);return n?(await O.handle(n,t),o()):e}))}()],I={"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"};var E={getInterceptors:()=>x,getMiddlewares:()=>T,getHeaders:()=>Object.assign({},I),addInterceptor(e){x.push(e)},setHeader(header,e){I[header]=e}},j=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(o.a)(e).options({context:n}).headers(E.getHeaders()).middlewares([...E.getMiddlewares(),Object(r.a)(),Object(c.a)([...E.getInterceptors(),...t])]).options({credentials:"same-origin",requestInfo:new l.a})},D=n(54),A=(e,t)=>{window.io_global_object_name="IGLOO";const n=new Promise((e=>{const t=setTimeout((()=>e("")),3e3);window.IGLOO=window.IGLOO||{enable_flash:!1,bb_callback:(n,o)=>{t&&clearTimeout(t),o&&e(n)},loader:{uri_hook:"/iojs",version:"general5"}}})),o=()=>{const script=document.createElement("script");script.type="text/javascript",script.src="https://www.upwork.com/static/iovation/5.2.2/loader_only.js",document.body.appendChild(script)};"loading"!==document.readyState?o():document.addEventListener("DOMContentLoaded",o,{once:!0});const r={bbPromise:n,getBlackbox:()=>window.IGLOO.getBlackbox()};return e?t("iovation",r):r},W=n(41);var L={openWebsocketWithToken(e){e||(e=W.a.getValueFromNameSelector(W.a.getPrefix()+"oauth2_global_js_token"));const t=window.NUXT_APP_CONFIG?NUXT_APP_CONFIG.transportLayerEndpoint:Applet.getVar("transport_layer_url");if(!t)throw new Error("Transport layer endpoint is not defined");return new WebSocket("".concat(t,"?app=AccountSecurity&libVersion=4.8.0&oauth2_token=").concat(e,"&X-Atmosphere-tracking-id=0&X-Atmosphere-Framework=2.3.8-javascript&X-Atmosphere-Transport=websocket&X-Atmosphere-TrackMessageSize=true&X-atmo-protocol=true"))}};var N=e=>async(t,n,o)=>{const data=t.data||{};if(n.locked=1!==n.retryCounter&&!!data.securityCheckCertificate,e&&e(n.locked),!n.locked)return t;await new Promise((async e=>{await function(e,t,n,o){if(e.resolve=o,e.webSocket)return Promise.resolve();return e.webSocket=L.openWebsocketWithToken(t),e.webSocket.onmessage=t=>{var o,r;let data={};try{data=JSON.parse(t.data)}catch(e){}const c=null===(o=data)||void 0===o||null===(o=o.data)||void 0===o?void 0:o.securityCheckId;"LOGIN_DECISION_AVAILABLE"!==(null===(r=data)||void 0===r?void 0:r.eventName)||c!==n&&c||(e.resolve(),e.webSocket.close()),e.webSocket.onclose=()=>e.webSocket=null},new Promise((t=>{e.webSocket.onopen=t,setTimeout(t,2e3)}))}(n,data.authToken,data.requestId,e),setTimeout((()=>e()),void 0===n.retryCounter?0:6e3)}));const r=JSON.parse(n.body);return Object.assign(r.login,{securityCheckCertificate:data.securityCheckCertificate,authToken:data.authToken}),n.body=JSON.stringify(r),n.retryCounter=void 0===n.retryCounter?30:n.retryCounter-1,o()};const $={MODE_PASSWORD:"password",MODE_SSO:"sso",MODE_CHALLENGE:"challenge"},G=0;let M=null,R={};function U(e){return 1===e.success?Promise.resolve(!0):Promise.reject(null==e?void 0:e.mode)}async function X(data){return data.iovation||(data.iovation=await new Promise((async e=>{setTimeout((()=>e("")),1e3),e(await A().bbPromise)}))),j(D.a,[N()]).headers(R).post({login:data}).json((e=>{if((null==e?void 0:e.challengeType)===G&&M){const t={login:{deviceAuthorization:{answer:M,remember:!0},mode:$.MODE_CHALLENGE,iovation:data.iovation,authToken:null==e?void 0:e.authToken,challengeData:null==e?void 0:e.challengeData}};return data.username?t.login.username=data.username:t.login.ssoUserData=data.ssoUserData,function(data){return j(D.a).headers(R).post(data).json((e=>U(e)))}(t)}return U(e)}))}var z={headers(e){return R=e,this},provideSecurityAnswer(e){return M=e,this},withSso:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return X({mode:$.MODE_SSO,ssoUserData:e,iovation:t})},withPassword:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return X({mode:$.MODE_PASSWORD,username:e,password:t,iovation:n})}};var J=function(e,t,n){n("impression","show_widget"),window.google.accounts.id.initialize({client_id:e,callback:e=>{t(e.credential)},cancel_on_tap_outside:!1}),window.google.accounts.id.prompt()};let H;var F={methods:{trackEvent(e){const t="page"===e.event?["olog"]:["olog","snowplow"];return this.$tracker.track({...e,trackers:t})},async logEvent(e){const t={...e};var n;n="id",{}.hasOwnProperty.call(e.data||{},n)&&(t.data.id=this.$store.state.context.user.uid),await this.trackEvent(t)},async logImpressionEvent(e,t){!H&&t&&(await this.logEvent(t),H=!0),await this.logEvent(e)},extendLogData:(e,data)=>({...e,data:{...e.data||{},...data}})}},V=n(0),B={mixins:[Object(V.a)(F,undefined,undefined,!1,null,null,null).exports],props:{clientId:{type:String,required:!0}},head(){return{script:[{hid:"google-qsi-client",src:"https://accounts.google.com/gsi/client",defer:!0,callback:()=>{J(this.clientId,this.authorize,this.logWidget)}}]}},methods:{authorize(e){this.processGoogleOneTapUser(e)},logWidget(e,label){this.logEvent({event:e,sublocation:"one_tap_sign_up",label:label})},async processGoogleOneTapUser(e){const t=await this.$iovation.bbPromise;await this.signUpWithOneTap(e,t)},async signUpWithOneTap(e,t){const{login:n,redirectTo:o}=await this.authorizeWithOneTap(e);if(n){try{if(!await this.logIn(t,n,e))return}catch(e){return window.localStorage.setItem("existingAccountLoginAlert",!0),void(window.location.href=this.$localePrefix("/ab/account-security/login"))}this.logWidget("click","existing_user_with_one_tap"),window.location.href=this.$localePrefix("/signup/home/")}else o&&(this.logWidget("click","new_user_with_one_tap"),window.location.href=this.$localePrefix(o))},authorizeWithOneTap(e){return this.$http({handleApiErrors:!1}).url("/signup/one-tap-redirect-url?credential=".concat(encodeURI(e))).get().json()},logIn(e,t,n){return z.withSso({email:t,clientId:this.clientId,provider:"google",authResponse:{id_token:n},iovation:e})}}},K=B,Q=Object(V.a)(K,(function(){return(0,this._self._c)("div")}),[],!1,null,null,null);t.default=Q.exports}}]);
//# sourceMappingURL=https://upwork-usw2-staging-assets-jsmaps.s3.us-west-2.amazonaws.com/Brontes/up-s-google-one-tap.84a87b26.js.map